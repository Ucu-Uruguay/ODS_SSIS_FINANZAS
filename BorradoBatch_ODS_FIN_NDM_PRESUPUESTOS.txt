SET NOCOUNT ON;
GO
DECLARE @r INT;
SET @r = 1;
WHILE @r > 0
BEGIN
 BEGIN TRANSACTION;
 DELETE TOP (250000)
 ODS_FIN_NDM_PRESUPUESTOS
 WHERE (ANIO = year(getdate()) OR ANIO = year(getdate())-1);
 SET @r = @@ROWCOUNT;
 COMMIT TRANSACTION;
END
GO
SET NOCOUNT OFF;
GO